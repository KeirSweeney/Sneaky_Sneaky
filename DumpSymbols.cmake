if(APPLE)
    execute_process(COMMAND dsymutil ${BINARY_PATH})
    execute_process(COMMAND ${DUMP_SYMS} -g ${BINARY_PATH}.dSYM ${BINARY_PATH} OUTPUT_FILE ${BINARY_PATH}.sym ERROR_QUIET)
    execute_process(COMMAND strip -S ${BINARY_PATH})
else()
    execute_process(COMMAND ${DUMP_SYMS} ${BINARY_PATH} OUTPUT_FILE ${BINARY_PATH}.sym ERROR_QUIET)
endif()

if(EXISTS ${BINARY_PATH}.sym)
    execute_process(COMMAND ${CMAKE_COMMAND} -E tar czf ${BINARY_PATH}.sym.tar.gz ${BINARY_PATH}.sym)
    #file(UPLOAD ${BINARY_PATH}.sym.tar.gz "http://traitor.limetech.org/symbols.php" INACTIVITY_TIMEOUT 30 SHOW_PROGRESS STATUS UPLOAD_STATUS)
    message("Completed upload. (${UPLOAD_STATUS})")
else()
    message("No symbol file generated.")
endif()
